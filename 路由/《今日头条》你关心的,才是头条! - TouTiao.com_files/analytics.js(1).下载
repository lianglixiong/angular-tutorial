!function(e,n){function r(){var e=arguments[0],n=typeof e,r=Array.prototype.slice.call(arguments,1);return new x(function(c){if("string"===n){var u=I(e);switch(u.command){case"create":c(t.apply(void 0,r));break;case"send":a(u.trackerName,r),c();break;case"set":o(u.trackerName,r),c();break;case"register":i(u.trackerName,r),c()}}else"function"===n&&e(U.namesMap[M.defaultTrackerName])})}function t(e,n){return new x(function(r){function t(){r(),o=!0}function a(){c=new f(n,l),U.idsMap[e]=c,U.namesMap[i]=c,t()}var o=!1;if(!e||"string"!=typeof e)return void t();var i,c;if(n&&"object"==typeof n||(n={}),i=n.name=n.name?n.name:M.defaultTrackerName,n.trackingId=e,U.idsMap[e])return t(),U.idsMap[e];if(U.namesMap[i])return t(),U.namesMap[i];var u=n.crossDomain;void 0!==n.clientId&&(n.clientId=y(n.clientId));var l=void 0!==n.clientId;u&&!l?P.init().then(function(){var r=P.getCID(e);r.then(function(e){e&&g(e)&&(n.clientId=e),a()},function(){a()})},function(){a()}).catch(function(e){console.log("Error when init iframe or get cross domain CID:"+e.message)}):a()})}function a(e,n){if(V){var r=U.namesMap[e];r&&r.send.apply(r,n)}}function o(e,n){var r=U.namesMap[e];r&&r.set.apply(r,n)}function i(e,n){if(e){var r=U.namesMap[e];r.register.apply(r,n)}else c.apply(void 0,n)}function c(e,n){if("string"==typeof e){var r=typeof n;if(("function"===r||"object"===r)&&E(n)&&!$[e]){$[e]=n;var t,a;for(t in U.namesMap)a=U.namesMap[t],a.register(e,n)}}}function u(e){var n=U.namesMap[e];if(n){delete U.namesMap[e];var r=n.get("trackingId");delete U.idsMap[r]}}function l(e){return void 0===e&&(e=""),U.namesMap[e]}function s(){var e=[];for(var n in U.namesMap)e.push(U.namesMap[n]);return e}function f(e,r){function t(e,n){if("string"!=typeof e)return this;var r=E(n);return r?(a[e]||(n="function"==typeof n?new n:w({},n),a[e]=n),this):this}var a={},o=w({},R),i=this,c=!1;!function(){var c;for(c in $)t.call(i,c,$[c]);var u=w({},e);o.gid=D(20);var l,s,f,c,p,m;for(s in u)if(u.hasOwnProperty(s))if(p=O(s),c=p.hitType,f=p.fieldName,c)l=a[c],l.has(s)&&l.set(f,u[s]);else{if(C.hasOwnProperty(s)&&C[s].configurable){o[s]=u[s];continue}m=!1;for(c in a)if(l=a[c],l.has(s)){l.set(f,u[s]),m=!0;break}}o.cookieName||(o.cookieName=R.cookieName),"none"===o.cookieDomain?o.cookieDomain="":"auto"===o.cookieDomain&&(o.cookieDomain=n.location.hostname||n.location.host),o.cookieExpires=parseFloat(o.cookieExpires),isNaN(o.cookieExpires)&&(o.cookieExpires=R.cookieExpires);var v={expires:o.cookieExpires,domain:o.cookieDomain,path:"/"};if(o.clientId)r||b(o.cookieName,o.clientId,v);else{var y=k(o.cookieName);y&&g(y)?o.clientId=y:(o.clientId=d(e.trackingId),b(o.cookieName,o.clientId,v))}if(e.crossDomain&&!r&&T)try{P.storeCID(e.trackingId,o.clientId)}catch(h){console.log("Error when store cross domain cid!")}var I=N(n.referrer).path,E=N(n.location.href).path;(o.alwaysSendReferrer||n.referrer&&I!==E)&&(o.referrer=n.referrer)}(),this.get=function(e){if("string"==typeof e){var n,r=a,t=O(e),i=t.hitType,c=t.fieldName;if(i)return n=r[i],n?n.get(c):void 0;if(e in C)return o[e];for(i in r)return n=r[i],n.get(c)}},this.set=function(e,n){function r(e,n,r){var t,a=O(e),i=a.hitType,c=a.fieldName;if(i)return t=r[i],t?t.set(c,n):void 0;if(e in C){var u=C[e];u.configurable&&!u.createOnly&&p(e,n)&&(o[e]=n)}else for(i in r)if(t=r[i],t.has(c))return t.set(c,n)}function t(e,n){for(var t in e)r(t,e[t],n)}var i=typeof e;return"string"===i?r(e,n,a):"object"===i&&t(e,a),this},this.send=function(e,n){function r(e){return e&&"object"==typeof e?!0:!1}if("string"==typeof e&&V){var t,i,u;if(e){"event"!==e||c||this.send("pageview",n);var l=typeof n;"string"===l?"pageview"===e?(i=M.pathReg.test(n)?{page:n}:{},r(arguments[2])&&(i=w(i,arguments[2]))):"event"===e?(i={eventCategory:n},l=typeof arguments[2],"string"===l?(i.eventAction=arguments[2],l=typeof arguments[3],"string"===l?(i.eventLabel=arguments[3],l=typeof arguments[4],"number"===l?(i.eventValue=arguments[4],r(arguments[5])&&(i=w(i,arguments[5]))):r(arguments[4])&&(i=w(i,arguments[4]))):r(arguments[3])&&(i=w(i,arguments[3]))):r(arguments[2])&&(i=w(i,arguments[2]))):i=void 0:i="object"===l&&l?w({},n):void 0;var s=a[e];if(s&&(t=s.send(i),t!==!1)){t&&"object"==typeof t||(t={});var f,p;for(u in o)f=C[u],f.param&&(p=f.param.supported,m(e,p)&&(t[u]=i&&i.hasOwnProperty(u)&&f.configurable&&!f.createOnly?{value:i[u],param:f.param.key}:{value:o[u],param:f.param.key},void 0!==t[u]&&f.type&&"boolean"===f.type.toLowerCase()&&(t[u].value=t[u].value?1:0)));return v(e,this.get("transport"),t),"pageview"===e&&(c=!0),t}}}},this.getName=function(){return o.name},this.register=t()}function p(e,n){switch(e){case"page":return M.pathReg.test(n);default:return!0}return!0}function m(e,n){return n.indexOf("all")>-1||e&&n.indexOf(e)>-1}function v(n,r,t){function a(n){if(F.isIE&&F.version<10)return o(n);var r=XMLHttpRequest||e.ActiveXObject("Microsoft.XMLHTTP"),t=new r;t.onreadystatechange=function(){2===t.readyState&&200!==t.status&&console.log("Error occur when send data to "+M.serverURL+" by xhr. Data:"+n)},t.open("post",M.serverURL),t.send(n)}function o(e){var n=new Image;n.onerror=function(){n.onload=n.onerror=null,console.log("Error occur when send data to "+M.serverURL)},n.onload=function(){n.onload=n.onerror=null},n.src=M.serverURL+"?"+e}function i(){}var c,u,l,s="t="+n;for(c in t)u=t[c].value,l=t[c].param,void 0!==u&&(s+="&"+l+"="+encodeURIComponent(u));s+="&z="+(new Date).getTime(),"none"===r?o(s):"image"===r?o(s):"xhr"===r?a(s):"bacon"===r?i(s):o(s)}function d(e){var n=h(),r=e.substr(e.length-5);return"BA"+M.$VERSION$+"-"+n+"-"+r+"-"+D(20)}function g(e){var n=/^BA([^\-]*)-(\d)+-(\w)+-(\w)+$/;return n.test(e)}function y(e){var n=typeof e,r="";if("string"==n||"number"===n){if(e=""+e,!/-\d{8}-/.test(e)){var t=h();r="BA"+M.$VERSION$+"-"+t,"-"!==e.charAt(0)&&(r+="-"),e=r+e}return e}return void 0}function h(){var e=new Date,n=e.getMonth()+1;n=10>n?"0"+n:n;var r=e.getDate();return r=10>r?"0"+r:r,""+e.getFullYear()+n+r}function b(n,r,t){w({},t),L.setCookie(n,r,t);var a=e.localStorage;a&&"object"==typeof a&&a.setItem&&(t.clientId=r,t.timestamp=(new Date).getTime(),a.setItem(n,j.stringify(t)))}function k(n){var r=L.getCookie(n);if(!r){var t=e.localStorage;if(t&&"object"==typeof t&&t.getItem){var a=t.getItem(n);if(a&&(a=j.parse(a),a&&"object"==typeof a)){var o=a.timestamp;o+parseFloat(a.expires)>(new Date).getTime()?(r=a.clientId,L.setCookie(n,r,{expires:a.expires,domain:a.cookieDomain,path:a.path})):t.removeItem(n)}}}return r}function O(e){var n={fieldName:"",hitType:""};if(!e||"string"!=typeof e)return n;var r=e.indexOf(".");return-1!==r?(n.hitType=e.substring(0,r),n.fieldName=e.substring(r+1)):n.fieldName=e,n}function I(e){var n={command:"",trackerName:""};if("create"===e)n.command="create",n.trackerName="";else{var r=e.indexOf(".");r>-1?(n.trackerName=e.substring(0,r),n.command=e.substring(r+1)):(n.command=e,n.trackerName=M.defaultTrackerName)}return n}function w(e){function n(e){if(!e||e!==Object(e))return!1;var n=Object.prototype.hasOwnProperty;try{if(e.constructor&&!n.call(e,"constructor")&&!n.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}var t;for(t in e);return void 0===t||n.call(e,t)}for(var r,t,a,o=[].slice.call(arguments,1),i=0,c=o.length;c>i;i++)if(r=o[i],r&&"object"==typeof r)for(t in r)a=r[t],r.hasOwnProperty(t)&&(e[t]=n(a)?n(e[t])?w({},e[t],a):w({},a):a);return e}function D(e,n){var r,t,a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),o=[],i=a.length;if(n=n||i,n=n>i?i:n,e)for(r=0;e>r;r++)t=0|Math.random()*n,o[r]=a[t];else{var c;for(o[8]=o[13]=o[18]=o[23]="-",o[14]="4",r=0;36>r;r++)o[r]||(c=0|16*Math.random(),o[r]=a[19==r?3&c|8:c])}return o.join("")}function E(e){var n=["send","set","get","has","getType"],r=typeof e;if("object"!==r&&"function"!==r)return!1;"function"===r&&(e=new e);for(var t=0;t<n.length;t++)if(!(n[t]in e))return!1;return!0}function x(e){function n(e){s=u,f=e;for(var n=0;n<p.length;n++)o.call(void 0,p[n]);p=null}function r(e){s=l,f=e;for(var n=0;n<p.length;n++)o.call(void 0,p[n]);p=null}function t(e){try{var o=i(e);if(o)return void a(o.bind(e),t,r);n(e)}catch(c){r(c)}}function a(e,n,r){var t=!1;try{e(function(e){if(!t){t=!0;try{n(e)}catch(r){throw r}}},function(e){t||(t=!0,r(e))})}catch(a){if(t)return;t=!0,r(a)}}function o(e){s===c?p.push(e):(s===u&&"function"==typeof e.onFulfilled&&e.onFulfilled(f),s===l&&"function"==typeof e.onRejected&&e.onRejected(f))}function i(e){var n=typeof e;if(e&&("object"===n||"function"===n)){var r=e.then;if("function"==typeof r)return r}return null}var c=0,u=1,l=2,s=c,f=null,p=[];this.done=function(e,n){setTimeout(function(){o({onFulfilled:e,onRejected:n})},0)},this.then=function(e,n){var r=this;return new x(function(t,a){var o=function(n){if("function"!=typeof e)return t(n);try{var r=e(n);return t(r)}catch(o){return a(o)}},i=function(e){if("function"!=typeof n)return a(e);try{var r=n(e);return t(r)}catch(o){return a(o)}};return r.done(o,i)})},this.catch=function(e){this.then(null,e)},a(e,t,r)}function N(e){var n=/^(?:([A-Za-z]+):)?(\/{0,3})([0-9.\-A-Za-z]+)(?::(\d+))?(?:\/([^?#]*))?(?:\?([^#]*))?(?:#(.*))?$/,r=n.exec(e),t=["url","scheme","slash","host","port","path","query","hash"],a={};if(r)for(var o=0;o<t.length;o++)a[t[o]]=r[o];return a}var T,M={$VERSION$:"0.2",$COLLECTAGENTVERSION$:"0.2.1",serverURL:"//analytics.snssdk.com/collect",defaultTrackerName:"",crossDomainIFrameID:"bytedance-ba-cid-iframe",crossDomainIFrameUrl:"//s3.bytecdn.cn/ta/resource/v0/crossDomain.html",crossDomainIFrameLoadTimeout:3e3,pathReg:/^\/[^?#]*$/},C={trackingId:{value:"",configurable:!0,createOnly:!0,param:{key:"tid",supported:"all"},required:!0},trackerName:{value:"",configurable:!0,createOnly:!0,param:!1},clientId:{value:"",configurable:!0,createOnly:!0,param:{key:"cid",supported:"all"}},gid:{value:"",configurable:!1,createOnly:!0,param:{key:"gid",supported:"all"}},version:{value:M.$VERSION$,configurable:!1,createOnly:!0,param:{key:"v",supported:"all"}},collectAgentVersion:{value:M.$COLLECTAGENTVERSION$,configurable:!1,createOnly:!0,param:{key:"cav",supported:"all"}},sampleRate:{value:100,configurable:!0,createOnly:!0,param:!1},alwaysSendReferrer:{value:!1,configurable:!0,createOnly:!0,param:!1},cookieName:{value:"_ba",configurable:!0,createOnly:!0,param:!1},cookieExpires:{value:63072e6,configurable:!0,createOnly:!0,param:!1},cookieDomain:{value:n.location.hostname||n.location.host,configurable:!0,createOnly:!0,param:!1},allowLinker:{value:!1,configurable:!0,createOnly:!0,param:!1},linkerParam:{value:"",configurable:!0,createOnly:!0,param:!1},crossDomain:{value:!1,configurable:!0,createOnly:!0,param:!1},transport:{value:"none",configurable:!0,createOnly:!1,param:!1},dataSource:{value:"web",configurable:!1,createOnly:!1,param:{key:"ds",supported:"all"}},hitCallback:{value:void 0,configurable:!0,createOnly:!1,param:!1},userId:{value:void 0,configurable:!0,createOnly:!1,param:{key:"uid",supported:"all"}},campaignName:{value:void 0,configurable:!0,createOnly:!1,param:{key:"cn",supported:"all"}},campaignSource:{value:void 0,configurable:!0,createOnly:!1,param:{key:"cs",supported:"all"}},campaignMedium:{value:void 0,configurable:!0,createOnly:!1,param:{key:"cm",supported:"all"}},campaignKeyword:{value:void 0,configurable:!0,createOnly:!1,param:{key:"ck",supported:"all"}},campaignContent:{value:void 0,configurable:!0,createOnly:!1,param:{key:"cc",supported:"all"}},campaignId:{value:void 0,configurable:!0,createOnly:!1,param:{key:"ci",supported:"all"}},nonInteraction:{value:void 0,type:"boolean",configurable:!0,createOnly:!1,param:{key:"ni",supported:"event"}},screenResolution:{value:e.screen.width+"x"+e.screen.height,configurable:!0,createOnly:!1,param:{key:"sr",supported:"all"}},screenColors:{value:e.screen.colorDepth,configurable:!0,createOnly:!1,param:{key:"sd",supported:"all"}},viewportSize:{value:n.documentElement.clientWidth+"x"+n.documentElement.clientHeight,configurable:!1,createOnly:!0,param:{key:"vp",supported:"all"}},documentEncoding:{value:n.characterSet||n.charset,configurable:!0,createOnly:!1,param:{key:"de",supported:"all"}},language:{value:navigator.language,configurable:!0,createOnly:!1,param:{key:"ul",supported:"all"}},network:{value:navigator.connection&&navigator.connection.type,configurable:!1,createOnly:!0,param:{key:"nt",supported:"all"}},location:{value:n.location.href,configurable:!0,createOnly:!1,param:{key:"dl",supported:"all"}},hostname:{value:n.location.host,configurable:!0,createOnly:!1,param:{key:"dh",supported:"all"}},page:{value:n.location.pathname,configurable:!0,createOnly:!1,param:{key:"dp",supported:"all"}},title:{value:n.title,configurable:!0,createOnly:!1,param:{key:"dt",supported:"all"}},referrer:{value:void 0,configurable:!0,createOnly:!1,param:{key:"dr",supported:"all"}}},R=function(){var e={};for(var n in C)e[n]=C[n].value;return e}(),L=function(){function e(e){var n=r(e);return"string"==typeof n?n=decodeURIComponent(n):null}function r(e){if(t(e)){var r=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),a=r.exec(n.cookie);if(a)return a[2]||null}return null}function t(e){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)}function a(e,n,r){o(e,encodeURIComponent(n),r)}function o(e,r,a){if(t(e)){a=a||{};var o=a.expires;"number"==typeof a.expires&&(o=new Date,o.setTime(o.getTime()+a.expires)),n.cookie=e+"="+r+(a.path?"; path="+a.path:"")+(o?"; expires="+o.toGMTString():"")+(a.domain?"; domain="+a.domain:"")+(a.secure?"; secure":"")}}return{isValidCookieKey:t,getCookie:e,getRawCookie:r,setCookie:a,setRawCookie:o}}(),j=e.JSON||function(){function e(e){return new Function("return ("+e+")")()}var n=function(){function e(e){return/["\\\x00-\x1f]/.test(e)&&(e=e.replace(/["\\\x00-\x1f]/g,function(e){var n=a[e];return n?n:(n=e.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})),'"'+e+'"'}function n(e){var n,r,t,a=["["],o=e.length;for(r=0;o>r;r++)switch(t=e[r],typeof t){case"undefined":case"function":case"unknown":break;default:n&&a.push(","),a.push(j.stringify(t)),n=1}return a.push("]"),a.join("")}function r(e){return 10>e?"0"+e:e}function t(e){return'"'+e.getFullYear()+"-"+r(e.getMonth()+1)+"-"+r(e.getTodayDate())+"T"+r(e.getHours())+":"+r(e.getMinutes())+":"+r(e.getSeconds())+'"'}var a={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return function(r){switch(typeof r){case"undefined":return"undefined";case"number":return isFinite(r)?String(r):"null";case"string":return e(r);case"boolean":return String(r);default:if(null===r)return"null";if(r instanceof Array)return n(r);if(r instanceof Date)return t(r);var a,o,i=["{"],c=j.stringify;for(var u in r)if(Object.prototype.hasOwnProperty.call(r,u))switch(o=r[u],typeof o){case"undefined":case"unknown":case"function":break;default:a&&i.push(","),a=1,i.push(c(u)+":"+c(o))}return i.push("}"),i.join("")}}}();return{parse:e,stringify:n}}(),F=function(){var e={isIE:!1,version:0};return/MSIE ([^;]+)/.test(navigator.userAgent)&&(e.isIE=!0,e.version=parseFloat(RegExp.$1)),e}(),S="ToutiaoAnalyticsObject",A=[],U={namesMap:{},idsMap:{}},$={},P=function(){function r(n){return new x(function(r){function t(){var n=event.data;if(n&&"object"==typeof n&&"Bytedance-Analytics"===n.type){if(!o){var a=n.cid;r(a),o=!0}e.removeEventListener("message",t,!1)}}var a=T,o=!1;if(!a)return r(),void(o=!0);e.addEventListener("message",t,!1);var i={method:"get",tid:n};a.contentWindow.postMessage(i,M.crossDomainIFrameUrl),setTimeout(function(){if(!o){var n=null;r(n),o=!0,e.removeEventListener("message",t,!1)}},500)})}function t(){return new x(function(e){function r(){t||(e(),t=!0)}var t=!1;T=n.getElementById(M.crossDomainIFrameID),T?T.loaded?r():(T.addEventListener("load",function(){r()},!1),setTimeout(function(){r()},M.crossDomainIFrameLoadTimeout)):(T=n.createElement("iframe"),T.id=M.crossDomainIFrameID,T.style.display="none",T.addEventListener("load",function(){r(),this.loaded=!0},!1),T.src=M.crossDomainIFrameUrl,n.getElementsByTagName("body")[0].appendChild(T),setTimeout(function(){r()},M.crossDomainIFrameLoadTimeout))})}function a(n,r){function t(){var n=event.data;n&&"object"==typeof n&&"Bytedance-Analytics"===n.type&&(n.success||console.log(n.msg),e.removeEventListener("message",t,!1))}var a=T;if(!a)return!1;e.addEventListener("message",t,!1);var o={method:"set",tid:n,cid:r};a.contentWindow.postMessage(o,M.crossDomainIFrameUrl)}return{getCID:r,storeCID:a,init:t}}(),V=function(){var e=!0;try{var r=n.createElement("DIV");r.style.cssText="width:1px;height:1px;position:absolute;left:-10000px;",n.body.appendChild(r),r.style.left||(e=!1),n.body.removeChild(r)}catch(t){e=!1}return r=null,e}();!function(){!function(){if(S in e&&"function"==typeof e[e[S]]){A=e[e[S]].q,e[e[S]].q=[],M.serverURL=e[e[S]].s?e[e[S]].s:M.serverURL,M.crossDomainIFrameUrl=e[e[S]].i?e[e[S]].i:M.crossDomainIFrameUrl;var r=n.createElement("a");r.href=M.crossDomainIFrameUrl,M.crossDomainIFrameUrl=r.href,r=null}A||(A=[])}(),e[e[S]]=r;var a,o,c;!function(){function e(e,n,r){function t(){var n=w({},o),t=!1;this.send=function(e){if(r&&r.sendOnce&&t)return!1;var o,i,c={};for(o in n)i=a[o],i.param&&(c[o]=e&&e.hasOwnProperty(o)&&i.configurable&&!i.createOnly?{value:e[o],param:i.param.key}:{value:n[o],param:i.param.key},i.type&&"boolean"===i.type.toLowerCase()&&(c[o].value=c[o].value?1:0));return t=!0,c},this.get=function(e){return"string"==typeof e&&a.hasOwnProperty(e)?n[e]:void 0},this.set=function(e,r){var t=a[e];return t&&t.configurable&&!t.createOnly?(n[e]=r,!0):!1},this.getType=function(){return e},this.has=function(e){return a.hasOwnProperty(e)}}var a=w({},n),o=function(){var e={};for(var n in a)e[n]=a[n].value;return e}();return t}a=e("pageview",{pageCategory:{value:void 0,configurable:!0,createOnly:!1,param:{key:"pc"}}},{sendOnce:!0}),o=e("event",{eventCategory:{value:void 0,configurable:!0,createOnly:!1,param:{key:"ec"}},eventAction:{value:void 0,configurable:!0,createOnly:!1,param:{key:"ea"}},eventLabel:{value:void 0,configurable:!0,createOnly:!1,param:{key:"el"}},eventValue:{value:void 0,configurable:!0,createOnly:!1,param:{key:"ev"},type:"number"}}),c=e("performance",{})}(),function(){if(r.create=t,r.remove=u,r.getByName=l,r.getAll=s,i(void 0,["pageview",a]),i(void 0,["event",o]),i(void 0,["performance",c]),A.length){for(var e,n=0;n<A.length;n++)e?!function(n){e=e.then(function(){return r.apply(void 0,n)})}(A[n]):!function(n){e=r.apply(void 0,n)}(A[n]);e&&e.catch(function(e){console.log(e.message)})}}()}(),"object"==typeof module&&module.hasOwnProperty("exports")&&(module.exports=exports=e[S])}(window,document);